{
  "name": "RCS Invoice Segmenter Config V1",
  "version": "1.0",
  "coords": { "normalized": true, "y_origin": "top", "precision": 6 },
  "defaults": { "min_height": 0.02 },
  "regions": [
    {
      "id": "header",
      "label": "Header",
      "on_pages": "first",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^INVOICE$", "^TAX\\s*INVOICE$"],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "below_only",
          "width": "page",
          "dy_max": 0.215
        },
        "margin": { "top": 0.012, "right": 0.006, "bottom": 0.0, "left": 0.0 }
      },
      "fallbacks": [
        { "y_cutoff": { "edge": "top", "y": 0.26 } }
      ],
      "keep": "all"
    },
    {
      "id": "seller",
      "label": "seller",
      "inside": "@header",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": [
            "^From\\b\\s*:?"
          ],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "left",
          "rows": 7,
          "row_tol": 0.006,
          "gap_x": 0.002      
        },
        "margin": { "top": 0.01, "right": 0.05, "bottom": -0.015, "left": -0.01 }
      }
    },
    {
      "id": "buyer",
      "label": "buyer",
      "inside": "@header",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": [
            "^For\\b\\s*:?"
          ],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "left",
          "rows": 9,
          "row_tol": 0.006,
          "gap_x": 0.002      
        },
        "margin": { "top": -0.017, "right": 0.0, "bottom": -0.015, "left": -0.01 }
      }
    },
    {
      "id": "currency",
      "label": "currency",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": [
            "^(USD|IDR|EUR|GBP|AUD|SGD|JPY|CNY)\\b",
            "^Currency\\b"
          ],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "left",
          "rows": 0,
          "row_tol": 0.0,
          "dx_max": 0.20,
          "width": "anchor"
        },
        "margin": { "top": -0.017, "right": 0.03, "bottom": -0.015, "left": -0.01 }
      }
    },
    {
      "id": "total",
      "label": "total",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^SUBTOTAL\\b"],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "last"
        },
        "capture_window": { "mode": "below_only", "dy_max": 0.12, "width": "page" },
        "margin": { "top": 0.01, "right": 0.05, "bottom": 0.03, "left": -0.32 },
        "min_height": 0.04
      },
      "keep": "all"
    },    
    {
      "id": "subtotal",
      "label": "subtotal",
      "inside": "@total",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^SUBTOTAL$"], 
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "right",
          "rows": 0,
          "row_tol": 0,
          "dx_max": 0.50
        },
        "margin": { "top": -0.012, "right": 0.03, "bottom": 0.004, "left": 0.05 },
        "min_height": 0.008
      }
    },
    {
      "id": "tax_rate",
      "label": "tax_rate",
      "inside": "@total",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^RATE$"], 
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "left",
          "rows": 0,
          "row_tol": 0,
          "dx_max": 0.50
        },
        "margin": { "top": -0.012, "right": 0.03, "bottom": 0.004, "left": 0.01 },
        "min_height": 0.008
      }
    },
    {
      "id": "sales_tax",
      "label": "sales_tax",
      "inside": "@total",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^SALES$"], 
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "right",
          "rows": 0,
          "row_tol": 0,
          "dx_max": 0.50
        },
        "margin": { "top": -0.012, "right": 0.03, "bottom": 0.004, "left": 0.02 },
        "min_height": 0.008
      }
    },
    {
      "id": "other",
      "label": "other",
      "inside": "@total",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^OTHER$"], 
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "left",
          "rows": 0,
          "row_tol": 0,
          "dx_max": 0.50
        },
        "margin": { "top": -0.012, "right": 0.03, "bottom": 0.004, "left": -0.015 },
        "min_height": 0.008
      }
    },
    {
      "id": "grand_total",
      "label": "grand_total",
      "inside": "@total",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^TOTAL$"], 
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "last"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "left",
          "rows": 0,
          "row_tol": 0,
          "dx_max": 0.50
        },
        "margin": { "top": -0.012, "right": 0.03, "bottom": 0.004, "left": -0.015 },
        "min_height": 0.008
      }
    },
    {
      "id": "invoice",
      "label": "invoice",
      "inside": "@header",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^Date:?$"],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "topmost"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "start_edge": "left",
          "rows": 3,           
          "row_tol": 0.004,
          "dx_max": 0.55,       
          "gap_x": 0
        },
        "margin": { "top": -0.01, "right": 0.03, "bottom": 0.008, "left": -0.02 },
        "min_height": 0.010
      },
      "keep": "all"
    },
{
      "id": "invoice_no",
      "label": "invoice_no",
      "inside": "@invoice",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["^#:$"],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "last"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "rows": 0,
          "row_tol": 0,
          "dx_max": 0.50,
          "gap_x": 0
        },
        "margin": { "top": -0.014, "right": 0.03, "bottom": 0.0, "left": 0.0 }
      }
    },
    {
      "id": "invoice_date",
      "label": "invoice_date",
      "inside": "@invoice",
      "detect": {
        "by": "anchors",
        "start_anchor": {
          "patterns": ["Date"],
          "flags": { "ignore_case": true, "normalize_space": true },
          "select": "last"
        },
        "capture_window": {
          "mode": "right_then_rows",
          "rows": 0,
          "row_tol": 0,
          "dx_max": 0.50,
          "gap_x": 0
        },
        "margin": { "top": -0.014, "right": 0.03, "bottom": 0.0, "left": 0.0 }
      }
    }






  ]
}
